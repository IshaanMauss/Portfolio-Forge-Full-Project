rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    // This is your existing rule, which is correct
    match /portfolios/{userId} {
      allow read, write: if request.auth.uid == userId;
    }

    // This is the new rule you need to add for the feedback system
    match /feedback/{feedbackId} {
      // Allows anyone (even not logged in) to create (submit) feedback
      allow create: if true;

      // Allows only the portfolio owner to read or delete their feedback
      allow read, delete: if request.auth != null && request.auth.uid == resource.data.portfolioOwnerId;
    }
  }
}